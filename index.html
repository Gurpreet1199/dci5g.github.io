<!DOCTYPE HTML>
<html>
<form name="frm" onsubmit="decode(); return false;" action="">
	<table class="form" cellspacing="0" align="center">
		<tbody>
			<tr>
				<td>Duplexing mode:</td>
				<td><select name="duplex_mode" onchange="decode1();" id="DM">
					<option value="TDD" selected="">TDD</option>
					<option value="FDD">FDD</option>
					
				</select></td>
				<td><span id="duplex_comment_div"></span></td>
			</tr>
			<tr id="tdd_sf_type_row" style="display: none;">
				<td>TDD subframe type:</td> 
				<td><select name="tdd_subframe_type" onchange="decode1();">
					<option value="normal" selected="">Normal</option>
					<option value="special">Special</option>   
				</select></td>
				<td><span id="tdd_sf_type_comment_div"></span></td>
			</tr>
			<tr>
				<td>Channel bandwidth:</td>
				<td><select name="bw" onchange="decode1();" id="CB">
					<option value="100 MHz" selected="">100 MHz</option>
					<option value="5 MHz">5 MHz</option>
					<option value="10 MHz">10 MHz</option>
					<option value="15 MHz">15 MHz</option>
					<option value="20 MHz">20 MHz</option>
					<option value="25 MHz">25 MHz</option>
					<option value="30 MHz">30 MHz</option>
					<option value="40 MHz">40 MHz</option>
					<option value="50 MHz">50 MHz</option>
					<option value="60 MHz">60 MHz</option>
					<option value="80 MHz">80 MHz</option>
					<option value="90 MHz">90 MHz</option>
				</select></td>
				<td><span id="bw_comment_div">(6 PRBs, 72 subcarriers)</span></td>
			</tr>
			<tr>
				<td>Number of Tx antenna ports:</td>
				<td><select name="n_tx_ports" onchange="de1code()" id="TX">
					<option value="4" selected="">4</option>
					<option value="1">1</option>
					<option value="2">2</option>
					
					<option value="8">8</option>
				</select></td>
				<td><span id="tx_port_comment_div"></span></td>
			</tr>
			<tr>
				<td>RNTI type:</td>
				<td><select name="rnti_type" onchange="decode1();" id="RNTI">
					<option value="c" selected="">C-RNTI</option> 
					<option value="si">SI-RNTI</option>         
					<option value="p">P-RNTI</option>
					<option value="ra">RA-RNTI</option>
					<option value="mcsc">MCS-C-RNTI</option>    
					<option value="cs">CS-RNTI</option> 
					<option value="tpcc">TPC-PUCCH-RNTI</option>
					<option value="tpcs">TPC-PUSCH-RNTI</option>       
				</select></td>
				<td><span id="rnti_type_comment_div"></span></td>
			</tr>
			<tr>
				<td>DCI hex value:</td>
				<td><input name="dci" onkeypress="if (decode_if_enter(event)) this.select();" onfocus="this.select();" onblur="decode1();" type="text" size="16" maxlength="16" value="" id="HEX"></td> 
				<td></td>
			</tr>
			<tr>
				<td>DCI length (bits):</td>
				<td colspan="2"><input name="dci_size" onkeypress="if (decode_if_enter(event)) this.select();" onfocus="this.select();" onblur="decode1();" type="text" size="2" maxlength="2" value="8" id="LEN">
				<select name="dci_justification" onchange="decode();">
					<option selected="">Left-aligned</option>
					<option>Right-aligned</option>
				</select>
				<select name="dci_read_direction" onchange="decode();">
					<option selected="">Read from left</option>
					<option>Read from right</option>
				</select></td> 
			</tr>
			<tr>
			<td></td>
			<td><input type="button" align="center" value="Submit" onclick="decode();"/></td>
			</tr>
			<tr>
				<td>All possible DCI lengths (bits):<br>(Bold ones are for given setup)</td>
				<td style="width: 1em;" colspan="2"><span id="possible_dci_lengths_div"><b><u>8</u></b>, 10, 12, 13, 14, 15, <b><u>19</u></b>, <b><u>21</u></b>, <b><u>22</u></b>, 23, 25, 27, <b><u>28</u></b>, 29, 30, <b><u>31</u></b>, 33, 34, 35, 36, 37, 38, 39, 41, 42, 43, 45, 46, 47, 48, 49, 50, 51, 53, 54, 57</span></td> 
			</tr>
		</tbody>
	</table>
</form>
<script>
	var map_cmc=new Map([[100,273],[90,245],[80,217],[60,162],[50,133],[40,106],[30,78],[25,65],[20,51],[15,38],[10,24],[5,11]]);
	function cmc_rnti(HEX,bw){
		var str=HEX;
		var res="";
		for(let i=0;i<str.length;i++){
			res+=parseInt(str[i],16).toString(2).padStart(4,'0');
		}
		var h1=document.createElement("h3");
		h1.setAttribute("align","center");
		h1.innerHTML="bit sequence : "+res;
		document.body.appendChild(h1);

		var fdsa=Math.ceil(Math.log(bw*(bw+1)/2)/Math.log(2));
		var sstr=res.substring(1,fdsa+1);
		var arr=[
		["Identifier For DCI Formats ",1,res.substring(0,1),parseInt(res.substring(0,1),2).toString(10)],
		["Frequency domain resource assignment",fdsa,sstr,parseInt(sstr,2).toString(10)],
		["Time domain resource assignment",4,res.substring(fdsa+1,fdsa+5),parseInt(res.substring(fdsa+1,fdsa+5),2).toString(10)],
		["VRB-TO-PRB Mapping",1,res.substring(fdsa+5,fdsa+6),parseInt(res.substring(fdsa+5,fdsa+6),2).toString(10)],
		["Modulation and Coding scheme(MCS)",5,res.substring(fdsa+6,fdsa+11),parseInt(res.substring(fdsa+6,fdsa+11),2).toString(10)],
		["Redundency version",2,res.substring(fdsa+11,fdsa+13),parseInt(res.substring(fdsa+11,fdsa+13),2).toString(10)],
		["HARQ process number ",4,res.substring(fdsa+13,fdsa+17),parseInt(res.substring(fdsa+13,fdsa+17),2).toString(10)],
		["Downlink Assignment index",2,res.substring(fdsa+17,fdsa+19),parseInt(res.substring(fdsa+17,fdsa+19),2).toString(10)],
		["TPC command for scheduled PUCCH ",2,res.substring(fdsa+19,fdsa+21),parseInt(res.substring(fdsa+19,fdsa+21),2).toString(10)],
		["PUCCH resource indicator ",3,res.substring(fdsa+21,fdsa+24),parseInt(res.substring(fdsa+21,fdsa+24),2).toString(10)],
		["PDSCH-to-HARQ_feedback timing indicator",3,res.substring(fdsa+24,fdsa+27),parseInt(res.substring(fdsa+24,fdsa+27),2).toString(10)],
	]
		return arr;

	}
	function si_rnti(HEX){
	var str=HEX;
	var res="";
	for(let i=0;i<str.length;i++){
		res+=parseInt(str[i],16).toString(2).padStart(4,'0');
	}
	var fdsa=Math.ceil(Math.log(48*49/2)/Math.log(2));
	var sstr=res.substring(0,fdsa);
	var arr=[["Frequency domain resource assignment",fdsa,sstr,parseInt(sstr,2).toString(10)],
	["Time domain resource assignment",4,res.substring(11,15),parseInt(res.substring(11,15),2).toString(10)],
	["VRB-TO-PRB Mapping",1,res.substring(15,16),parseInt(res.substring(15,16),2).toString(10)],
	["Modulation and Coding scheme(MCS)",5,res.substring(16,21),parseInt(res.substring(16,21),2).toString(10)],
	["Redundency version",2,res.substring(21,23),parseInt(res.substring(21,23),2).toString(10)],
	["System Information Indicator ",1,res.substring(23,24),parseInt(res.substring(23,24),2).toString(10)],
	["Reserved Bits",15,res.substring(24,39),parseInt(res.substring(24,39),2).toString(10)]]
	return arr;
}
	function tbl(arr){
		var br=document.createElement("br");
		document.body.appendChild(br);
		var table = document.createElement('table');
		table.setAttribute("align","center");
		table.setAttribute("cellspacing","2px");
		table.setAttribute("id","img");
		table.setAttribute("border","1px dotted #999");
		
		var header = ['NAME ','  BITS_ALLOCATED  ', '  BIT_SEQUENCE  ', '  VALUE  ' ];
		var tr=document.createElement('tr');
		for(var column in header)
		{   
			var th=document.createElement('th');
			th.setAttribute("style","text-align:center");
			th.innerHTML = header[column];
			tr.appendChild(th)
		}
		table.appendChild(tr);

		//create Table Body
		var input = arr;

		for(var row in input)
		{
		var tr=document.createElement('tr');
		tr.setAttribute("style","text-align:center");
			for(var column in input[row]){

				var td=document.createElement('td');
				td.innerHTML = input[row][column];
				tr.appendChild(td)

			}
		table.appendChild(tr);
		}

		// append Table
		document.body.appendChild(table);
		
}
	function decode(){
		var DM=document.getElementById("DM").value;
		var CB=document.getElementById("CB").value;
		var TX=document.getElementById("TX").value;
		var RNTI=document.getElementById("RNTI").value;
		var HEX=document.getElementById("HEX").value;
		var LEN=document.getElementById("LEN").value;
		alert(DM+" "+CB+" "+TX+" "+RNTI+" "+HEX +" "+ LEN);
		if(RNTI=='si'){
			tbl(si_rnti(HEX));
		}
		else if(RNTI=='c' || RNTI=='mcsc' || RNTI=='cs'){
			var x=map_cmc.get(parseInt(CB,10));
			tbl(cmc_rnti(HEX,x));
		}	
	
}
</script>
</html>